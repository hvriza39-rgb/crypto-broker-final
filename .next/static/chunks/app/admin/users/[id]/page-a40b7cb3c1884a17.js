(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{9349:function(e,t,a){Promise.resolve().then(a.bind(a,2762))},2762:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(7437),n=a(2265),r=a(9376),l=a(757),i=a(2827),c=a(6819),o=a(6334),u=a(9680),d=a(8702);function h(){let{id:e}=(0,r.useParams)(),t=(0,r.useRouter)(),[a,h]=(0,n.useState)(null),[x,f]=(0,n.useState)(!0),[m,g]=(0,n.useState)(!1),[p,b]=(0,n.useState)(null),[v,j]=(0,n.useState)(null),[y,w]=(0,n.useState)(!1),[N,Z]=(0,n.useState)("add"),[S,C]=(0,n.useState)(""),[k,P]=(0,n.useState)(!1);function A(e,t){h(a=>a?{...a,[e]:t}:a)}async function B(){if(a){g(!0),b(null),j(null);try{let t=await fetch("/api/admin/users/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:a.fullName,email:a.email,phone:a.phone,country:a.country,accountStatus:a.accountStatus,kycStatus:a.kycStatus})});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Update failed")}let s=await t.json();h(s.user),b("User updated")}catch(e){j((null==e?void 0:e.message)||"Update failed")}finally{g(!1)}}}async function E(){b(null),j(null);try{let t=await fetch("/api/admin/users/".concat(e,"/reset-password"),{method:"POST"});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Reset failed")}b("Password reset initiated")}catch(e){j((null==e?void 0:e.message)||"Reset failed")}}async function F(){if(!a)return;let t=parseFloat(S);if(!Number.isFinite(t)||t<=0){j("Please enter a valid amount");return}P(!0),b(null),j(null);try{let a=await fetch("/api/admin/users/".concat(e,"/balance"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operation:N,amount:t})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Balance update failed")}let s=await a.json();h(s.user),b("Balance ".concat("add"===N?"added":"subtracted"," successfully")),w(!1),C("")}catch(e){j((null==e?void 0:e.message)||"Balance update failed")}finally{P(!1)}}return((0,n.useEffect)(()=>{let t=!1;return f(!0),j(null),fetch("/api/admin/users/".concat(e)).then(async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error((null==t?void 0:t.error)||"Failed to load user")}return e.json()}).then(e=>{t||h(e.user)}).catch(e=>{t||j((null==e?void 0:e.message)||"Failed to load user")}).finally(()=>{t||f(!1)}),()=>{t=!0}},[e]),x)?(0,s.jsx)("div",{className:"text-muted",children:"Loading..."}):v?(0,s.jsx)(u.Z,{variant:"error",children:v}):a?(0,s.jsxs)("div",{className:"space-y-4",children:[p&&(0,s.jsx)(u.Z,{variant:"success",children:p}),v&&(0,s.jsx)(u.Z,{variant:"error",children:v}),(0,s.jsxs)(l.Z,{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-lg font-semibold",children:["User: ",a.fullName]}),(0,s.jsx)(o.Z,{variant:"secondary",onClick:()=>t.back(),children:"Back"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(i.Z,{label:"Full name",value:a.fullName,onChange:e=>A("fullName",e.target.value)}),(0,s.jsx)(i.Z,{label:"Email",value:a.email,onChange:e=>A("email",e.target.value)}),(0,s.jsx)(i.Z,{label:"Phone",value:a.phone||"",onChange:e=>A("phone",e.target.value)}),(0,s.jsx)(i.Z,{label:"Country",value:a.country||"",onChange:e=>A("country",e.target.value)}),(0,s.jsxs)(c.Z,{label:"Account status",value:a.accountStatus,onChange:e=>A("accountStatus",e.target.value),children:[(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"suspended",children:"Suspended"}),(0,s.jsx)("option",{value:"closed",children:"Closed"})]}),(0,s.jsxs)(c.Z,{label:"KYC status",value:a.kycStatus,onChange:e=>A("kycStatus",e.target.value),children:[(0,s.jsx)("option",{value:"pending",children:"Pending"}),(0,s.jsx)("option",{value:"verified",children:"Verified"}),(0,s.jsx)("option",{value:"rejected",children:"Rejected"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1 text-muted",children:"Balance"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.Z,{value:"$".concat(a.balance.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),readOnly:!0,className:"flex-1"}),(0,s.jsx)(o.Z,{onClick:()=>w(!0),children:"Adjust"})]})]}),(0,s.jsx)(i.Z,{label:"Created at",value:new Date(a.createdAt).toLocaleString(),readOnly:!0})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,s.jsx)(o.Z,{onClick:B,loading:m,disabled:m,children:m?"Saving...":"Save changes"}),(0,s.jsx)(o.Z,{variant:"danger",onClick:E,children:"Reset password"})]})]}),(0,s.jsx)(d.Z,{open:y,title:"Adjust User Balance",onClose:()=>{w(!1),C("")},children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-sm text-muted",children:["Current balance:"," ",(0,s.jsxs)("span",{className:"font-semibold text-text",children:["$",a.balance.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)(c.Z,{label:"Operation",value:N,onChange:e=>Z(e.target.value),children:[(0,s.jsx)("option",{value:"add",children:"Add to balance"}),(0,s.jsx)("option",{value:"subtract",children:"Subtract from balance"})]}),(0,s.jsx)(i.Z,{label:"Amount ($)",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:S,onChange:e=>C(e.target.value)}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(o.Z,{variant:"secondary",onClick:()=>{w(!1),C("")},children:"Cancel"}),(0,s.jsx)(o.Z,{onClick:F,loading:k,disabled:k||!S,children:k?"Processing...":"Update Balance"})]})]})})]}):(0,s.jsx)(u.Z,{variant:"error",children:"User not found"})}},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},6334:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437),n=a(1994);function r(e){let{className:t,variant:a="primary",loading:r,disabled:l,children:i,...c}=e;return(0,s.jsx)("button",{disabled:r||l,className:(0,n.Z)("inline-flex items-center justify-center px-6 py-3 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[#0b1220]","primary"===a&&"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 focus:ring-blue-500","secondary"===a&&"bg-white/5 hover:bg-white/10 text-white border border-white/10 focus:ring-gray-500","danger"===a&&"bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 focus:ring-red-500","ghost"===a&&"bg-transparent hover:bg-white/5 text-gray-400 hover:text-white",(r||l)&&"opacity-50 cursor-not-allowed",t),...c,children:r?(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):i})}},757:function(e,t,a){"use strict";var s=a(7437);a(2265);var n=a(1994);t.Z=e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,n.Z)("bg-surface border border-border rounded-xl shadow-card p-6","transition hover:shadow-lg",a),children:t})}},9680:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437),n=a(1994);function r(e){let{variant:t="info",children:a,className:r}=e;return(0,s.jsx)("div",{className:(0,n.Z)("rounded-md px-3 py-2 text-sm border border-border","success"===t?"bg-success/20 text-success":"error"===t?"bg-danger/20 text-danger":"bg-accent/20 text-accent",r),children:a})}},2827:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437),n=a(1994);function r(e){let{className:t,label:a,hint:r,...l}=e;return(0,s.jsxs)("label",{className:"block space-y-2",children:[a&&(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 ml-1",children:a}),(0,s.jsx)("input",{className:(0,n.Z)("w-full rounded-lg bg-[#111827] border border-white/10 px-4 py-3 text-white transition-all duration-200","focus:bg-[#1f2937] focus:border-blue-500/50 focus:ring-4 focus:ring-blue-500/10 outline-none","placeholder:text-gray-600 text-sm md:text-base",t),...l}),r&&(0,s.jsx)("span",{className:"text-xs text-gray-500 italic px-1",children:r})]})}},8702:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(7437);function n(e){let{open:t,onClose:a,title:n,children:r}=e;return t?(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:a}),(0,s.jsx)("div",{className:"absolute inset-0 grid place-items-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-lg rounded-xl bg-surface border border-border shadow-card",children:[n&&(0,s.jsx)("div",{className:"px-4 py-3 border-b border-border text-lg",children:n}),(0,s.jsx)("div",{className:"p-4 space-y-4",children:r})]})})]}):null}},6819:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437),n=a(1994);function r(e){let{className:t,label:a,hint:r,children:l,...i}=e;return(0,s.jsxs)("label",{className:"block space-y-2",children:[a&&(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider text-gray-500 ml-1",children:a}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("select",{className:(0,n.Z)("w-full appearance-none rounded-lg bg-[#111827] border border-white/10 px-4 py-3 text-white transition-all duration-200","focus:bg-[#1f2937] focus:border-blue-500/50 focus:ring-4 focus:ring-blue-500/10 outline-none","placeholder:text-gray-600 text-sm md:text-base",t),...i,children:l}),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-500",children:(0,s.jsx)("svg",{className:"h-4 w-4 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"})})})]}),r&&(0,s.jsx)("span",{className:"text-xs text-gray-500 italic px-1",children:r})]})}},1994:function(e,t,a){"use strict";t.Z=function(){for(var e,t,a=0,s="",n=arguments.length;a<n;a++)(e=arguments[a])&&(t=function e(t){var a,s,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var r=t.length;for(a=0;a<r;a++)t[a]&&(s=e(t[a]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s)}return n}(e))&&(s&&(s+=" "),s+=t);return s}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=9349)}),_N_E=e.O()}]);