(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{6340:function(e,a,t){Promise.resolve().then(t.bind(t,5019))},9376:function(e,a,t){"use strict";var n=t(5475);t.o(n,"useParams")&&t.d(a,{useParams:function(){return n.useParams}}),t.o(n,"usePathname")&&t.d(a,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(a,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(a,{useSearchParams:function(){return n.useSearchParams}})},5019:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var n=t(7437),r=t(2265),s=t(9376),l=t(757),i=t(2827),o=t(6819),c=t(6334),u=t(9680),d=t(8702);function h(){let{id:e}=(0,s.useParams)(),a=(0,s.useRouter)(),[t,h]=(0,r.useState)(null),[f,x]=(0,r.useState)(!0),[m,b]=(0,r.useState)(!1),[v,g]=(0,r.useState)(null),[p,j]=(0,r.useState)(null),[y,w]=(0,r.useState)(!1),[N,S]=(0,r.useState)("add"),[Z,C]=(0,r.useState)(""),[k,P]=(0,r.useState)(!1);function A(e,a){h(t=>t?{...t,[e]:a}:t)}async function B(){if(t){b(!0),g(null),j(null);try{let a=await fetch("/api/admin/users/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:t.fullName,email:t.email,phone:t.phone,country:t.country,accountStatus:t.accountStatus,kycStatus:t.kycStatus})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Update failed")}let n=await a.json();h(n.user),g("User updated")}catch(e){j((null==e?void 0:e.message)||"Update failed")}finally{b(!1)}}}async function E(){g(null),j(null);try{let a=await fetch("/api/admin/users/".concat(e,"/reset-password"),{method:"POST"});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Reset failed")}g("Password reset initiated")}catch(e){j((null==e?void 0:e.message)||"Reset failed")}}async function F(){if(!t)return;let a=parseFloat(Z);if(!Number.isFinite(a)||a<=0){j("Please enter a valid amount");return}P(!0),g(null),j(null);try{let t=await fetch("/api/admin/users/".concat(e,"/balance"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operation:N,amount:a})});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Balance update failed")}let n=await t.json();h(n.user),g("Balance ".concat("add"===N?"added":"subtracted"," successfully")),w(!1),C("")}catch(e){j((null==e?void 0:e.message)||"Balance update failed")}finally{P(!1)}}return((0,r.useEffect)(()=>{let a=!1;return x(!0),j(null),fetch("/api/admin/users/".concat(e)).then(async e=>{if(!e.ok){let a=await e.json().catch(()=>({}));throw Error((null==a?void 0:a.error)||"Failed to load user")}return e.json()}).then(e=>{a||h(e.user)}).catch(e=>{a||j((null==e?void 0:e.message)||"Failed to load user")}).finally(()=>{a||x(!1)}),()=>{a=!0}},[e]),f)?(0,n.jsx)("div",{className:"text-muted",children:"Loading..."}):p?(0,n.jsx)(u.Z,{variant:"error",children:p}):t?(0,n.jsxs)("div",{className:"space-y-4",children:[v&&(0,n.jsx)(u.Z,{variant:"success",children:v}),p&&(0,n.jsx)(u.Z,{variant:"error",children:p}),(0,n.jsxs)(l.Z,{className:"p-6 space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("h2",{className:"text-lg font-semibold",children:["User: ",t.fullName]}),(0,n.jsx)(c.Z,{variant:"secondary",onClick:()=>a.back(),children:"Back"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)(i.Z,{label:"Full name",value:t.fullName,onChange:e=>A("fullName",e.target.value)}),(0,n.jsx)(i.Z,{label:"Email",value:t.email,onChange:e=>A("email",e.target.value)}),(0,n.jsx)(i.Z,{label:"Phone",value:t.phone||"",onChange:e=>A("phone",e.target.value)}),(0,n.jsx)(i.Z,{label:"Country",value:t.country||"",onChange:e=>A("country",e.target.value)}),(0,n.jsxs)(o.Z,{label:"Account status",value:t.accountStatus,onChange:e=>A("accountStatus",e.target.value),children:[(0,n.jsx)("option",{value:"active",children:"Active"}),(0,n.jsx)("option",{value:"suspended",children:"Suspended"}),(0,n.jsx)("option",{value:"closed",children:"Closed"})]}),(0,n.jsxs)(o.Z,{label:"KYC status",value:t.kycStatus,onChange:e=>A("kycStatus",e.target.value),children:[(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"verified",children:"Verified"}),(0,n.jsx)("option",{value:"rejected",children:"Rejected"})]}),(0,n.jsxs)("div",{className:"flex items-end gap-2",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)(i.Z,{label:"Balance",value:"$".concat(t.balance.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),readOnly:!0})}),(0,n.jsx)("div",{className:"mb-[2px]",children:(0,n.jsx)(c.Z,{onClick:()=>w(!0),children:"Adjust"})})]}),(0,n.jsx)(i.Z,{label:"Created at",value:new Date(t.createdAt).toLocaleString(),readOnly:!0})]}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,n.jsx)(c.Z,{onClick:B,loading:m,disabled:m,children:m?"Saving...":"Save changes"}),(0,n.jsx)(c.Z,{variant:"danger",onClick:E,children:"Reset password"})]})]}),(0,n.jsx)(d.Z,{open:y,title:"Adjust User Balance",onClose:()=>{w(!1),C("")},children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-sm text-muted",children:["Current balance:"," ",(0,n.jsxs)("span",{className:"font-semibold text-text",children:["$",t.balance.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,n.jsxs)(o.Z,{label:"Operation",value:N,onChange:e=>S(e.target.value),children:[(0,n.jsx)("option",{value:"add",children:"Add to balance"}),(0,n.jsx)("option",{value:"subtract",children:"Subtract from balance"})]}),(0,n.jsx)(i.Z,{label:"Amount ($)",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:Z,onChange:e=>C(e.target.value)}),(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(c.Z,{variant:"secondary",onClick:()=>{w(!1),C("")},children:"Cancel"}),(0,n.jsx)(c.Z,{onClick:F,loading:k,disabled:k||!Z,children:k?"Processing...":"Update Balance"})]})]})})]}):(0,n.jsx)(u.Z,{variant:"error",children:"User not found"})}},6334:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});var n=t(7437),r=t(1994);function s(e){let{className:a,variant:t="primary",loading:s,disabled:l,children:i,...o}=e;return(0,n.jsx)("button",{disabled:s||l,className:(0,r.Z)("inline-flex items-center justify-center px-6 py-3 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-[#0b1220]","primary"===t&&"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 focus:ring-blue-500","secondary"===t&&"bg-white/5 hover:bg-white/10 text-white border border-white/10 focus:ring-gray-500","danger"===t&&"bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/20 focus:ring-red-500","ghost"===t&&"bg-transparent hover:bg-white/5 text-gray-400 hover:text-white",(s||l)&&"opacity-50 cursor-not-allowed",a),...o,children:s?(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):i})}},757:function(e,a,t){"use strict";var n=t(7437);t(2265);var r=t(1994);a.Z=e=>{let{children:a,className:t}=e;return(0,n.jsx)("div",{className:(0,r.Z)("bg-surface border border-border rounded-xl shadow-card p-6","transition hover:shadow-lg",t),children:a})}},9680:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});var n=t(7437);function r(e){let{variant:a="info",children:t}=e;return(0,n.jsx)("div",{className:"px-4 py-3 rounded-lg border text-sm ".concat({success:"bg-green-500/10 text-green-400 border-green-500/20",error:"bg-red-500/10 text-red-400 border-red-500/20",warning:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20",info:"bg-blue-500/10 text-blue-400 border-blue-500/20"}[a]),children:t})}},2827:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});var n=t(7437);function r(e){let{label:a,className:t="",...r}=e;return(0,n.jsxs)("div",{className:"space-y-1.5",children:[(0,n.jsx)("label",{className:"text-xs font-medium text-gray-400 ml-1",children:a}),(0,n.jsx)("input",{className:"w-full bg-[#0b1220] border border-white/10 rounded-xl px-4 py-2.5 text-white focus:outline-none focus:border-blue-500 transition-colors ".concat(t),...r})]})}},8702:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});var n=t(7437);function r(e){let{open:a,onClose:t,title:r,children:s}=e;return a?(0,n.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:t}),(0,n.jsx)("div",{className:"absolute inset-0 grid place-items-center p-4",children:(0,n.jsxs)("div",{className:"w-full max-w-lg rounded-xl bg-surface border border-border shadow-card",children:[r&&(0,n.jsx)("div",{className:"px-4 py-3 border-b border-border text-lg",children:r}),(0,n.jsx)("div",{className:"p-4 space-y-4",children:s})]})})]}):null}},6819:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});var n=t(7437);function r(e){let{label:a,className:t="",children:r,...s}=e;return(0,n.jsxs)("div",{className:"space-y-1.5",children:[(0,n.jsx)("label",{className:"text-xs font-medium text-gray-400 ml-1",children:a}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("select",{className:"w-full appearance-none bg-[#0b1220] border border-white/10 rounded-xl px-4 py-2.5 text-white focus:outline-none focus:border-blue-500 transition-colors ".concat(t),...s,children:r}),(0,n.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-4 text-gray-400",children:(0,n.jsx)("svg",{className:"h-4 w-4 fill-current",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"})})})]})]})}},1994:function(e,a,t){"use strict";a.Z=function(){for(var e,a,t=0,n="",r=arguments.length;t<r;t++)(e=arguments[t])&&(a=function e(a){var t,n,r="";if("string"==typeof a||"number"==typeof a)r+=a;else if("object"==typeof a){if(Array.isArray(a)){var s=a.length;for(t=0;t<s;t++)a[t]&&(n=e(a[t]))&&(r&&(r+=" "),r+=n)}else for(n in a)a[n]&&(r&&(r+=" "),r+=n)}return r}(e))&&(n&&(n+=" "),n+=a);return n}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=6340)}),_N_E=e.O()}]);