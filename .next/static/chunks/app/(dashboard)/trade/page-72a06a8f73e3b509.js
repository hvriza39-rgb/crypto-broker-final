(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[849],{4672:function(e,t,a){Promise.resolve().then(a.bind(a,1884))},1884:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var s=a(7437),r=a(2265),l=a(1804),o=a(1817);let n=(0,a(9205).Z)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);var i=a(9064);function c(){let[e,t]=(0,r.useState)("BTCUSD"),[a,c]=(0,r.useState)(0),[d,x]=(0,r.useState)(""),[h,m]=(0,r.useState)(0),[f,u]=(0,r.useState)(!1),[b,g]=(0,r.useState)("BUY"),[p,w]=(0,r.useState)([]),[v,j]=(0,r.useState)([]),y=async()=>{let e=localStorage.getItem("token");if(e)try{let t=await fetch("/api/user/dashboard",{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();a.balances&&m(a.balances.available)}catch(e){console.error(e)}};(0,r.useEffect)(()=>{y()},[]),(0,r.useEffect)(()=>{let t=async()=>{try{let t="BTCUSD"===e?"BTCUSDT":"ETHUSD"===e?"ETHUSDT":"SOLUSD"===e?"SOLUSDT":"BTCUSDT",a=await fetch("/api/price?symbol=".concat(t)),s=await a.json();if(s.price){let e=parseFloat(s.price);c(e);let t=5e-4*e;j(Array.from({length:5},(a,s)=>({price:(e+(s+1)*t).toFixed(2),amount:(1.5*Math.random()).toFixed(4)})).reverse()),w(Array.from({length:5},(a,s)=>({price:(e-(s+1)*t).toFixed(2),amount:(1.5*Math.random()).toFixed(4)})))}}catch(e){console.error("Failed to fetch price")}};t();let a=setInterval(t,3e3);return()=>clearInterval(a)},[e]);let N=async()=>{if(!d||0>=Number(d)){i.Am.error("Enter a valid amount");return}if("BUY"===b&&Number(d)>h){i.Am.error("Insufficient USD Balance");return}u(!0);let t=localStorage.getItem("token");try{let s=await fetch("/api/transaction/trade",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({action:b,asset:e.replace("USD",""),amount:Number(d),price:a})}),r=await s.json();if(!s.ok)throw Error(r.error||"Trade Failed");i.Am.success("".concat(b," Order Filled!"),{icon:"BUY"===b?"\uD83D\uDE80":"\uD83D\uDCB0",style:{background:"#1a1f2e",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}}),x(""),y()}catch(e){i.Am.error(e.message)}finally{u(!1)}},S=e=>{"BUY"===b?x((h*e).toFixed(2)):(0,i.Am)("For SELL, amount logic would go here")};return(0,s.jsxs)("div",{className:"h-[calc(100vh-80px)] p-4 flex flex-col lg:flex-row gap-4 text-white overflow-hidden",children:[(0,s.jsx)(i.x7,{position:"bottom-right"}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col gap-4 min-w-0",children:[(0,s.jsx)("div",{className:"bg-[#1a1f2e] border border-white/10 p-4 rounded-xl flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h2",{className:"text-xl font-bold flex items-center gap-2",children:e}),(0,s.jsx)("span",{className:"text-xs text-blue-400 font-mono",children:"Perpetual Contract"})]}),(0,s.jsx)("div",{className:"h-8 w-px bg-white/10 mx-2 hidden md:block"}),(0,s.jsx)("div",{className:"text-2xl font-mono font-bold text-white",children:a>0?"$".concat(a.toLocaleString(void 0,{minimumFractionDigits:2})):"Loading..."})]})}),(0,s.jsx)("div",{className:"flex-1 bg-[#1a1f2e] border border-white/10 rounded-xl overflow-hidden relative shadow-2xl",children:(0,s.jsx)("iframe",{src:"https://s.tradingview.com/widgetembed/?frameElementId=tradingview_76d87&symbol=".concat(e,"&interval=15&hidesidetoolbar=1&hidetoptoolbar=0&symboledit=1&saveimage=1&toolbarbg=f1f3f6&studies=[]&theme=dark&style=1&timezone=Etc%2FUTC&studies_overrides={}&overrides={}&enabled_features=[]&disabled_features=[]&locale=en&utm_source=localhost&utm_medium=widget&utm_campaign=chart&utm_term=").concat(e),className:"w-full h-full border-0 absolute inset-0",allowTransparency:!0,scrolling:"no"})})]}),(0,s.jsxs)("div",{className:"w-full lg:w-[320px] flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"bg-[#1a1f2e] border border-white/10 rounded-xl p-5 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex bg-[#0b1220] p-1 rounded-lg mb-6",children:[(0,s.jsx)("button",{onClick:()=>g("BUY"),className:"flex-1 py-2 rounded-md text-sm font-bold transition-all ".concat("BUY"===b?"bg-green-600 text-white shadow-lg":"text-gray-400 hover:text-white"),children:"BUY"}),(0,s.jsx)("button",{onClick:()=>g("SELL"),className:"flex-1 py-2 rounded-md text-sm font-bold transition-all ".concat("SELL"===b?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"),children:"SELL"})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xs mb-2",children:[(0,s.jsxs)("span",{className:"text-gray-500 flex items-center gap-1",children:[(0,s.jsx)(l.Z,{size:12})," Avail. Balance"]}),(0,s.jsxs)("span",{className:"text-white font-mono",children:["$",h.toLocaleString()]})]}),(0,s.jsxs)("div",{className:"bg-[#0b1220] border border-white/10 rounded-lg p-3 mb-4 flex items-center justify-between focus-within:border-blue-500 transition-colors",children:[(0,s.jsx)("span",{className:"text-gray-500 text-sm",children:"Amount"}),(0,s.jsx)("input",{type:"number",value:d,onChange:e=>x(e.target.value),className:"bg-transparent text-right text-white font-mono outline-none w-24",placeholder:"0.00"}),(0,s.jsx)("span",{className:"text-gray-400 text-xs ml-2",children:"USD"})]}),(0,s.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-6",children:[.25,.5,.75,1].map(e=>(0,s.jsxs)("button",{onClick:()=>S(e),className:"bg-[#0b1220] hover:bg-white/10 text-gray-400 hover:text-white text-[10px] py-1 rounded border border-white/5 transition-colors",children:[100*e,"%"]},e))}),(0,s.jsx)("button",{onClick:N,disabled:f||0===a,className:"w-full py-3.5 rounded-xl font-bold text-white transition-all shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed ".concat("BUY"===b?"bg-green-600 hover:bg-green-500 shadow-green-900/20":"bg-red-600 hover:bg-red-500 shadow-red-900/20"),children:f?(0,s.jsx)(o.Z,{className:"animate-spin mx-auto"}):"".concat(b," BTC")})]}),(0,s.jsxs)("div",{className:"bg-[#1a1f2e] border border-white/10 rounded-xl p-4 flex-1 shadow-xl overflow-hidden flex flex-col",children:[(0,s.jsxs)("h3",{className:"text-xs font-bold text-gray-400 mb-3 flex justify-between",children:[(0,s.jsx)("span",{children:"Price (USD)"}),(0,s.jsx)("span",{children:"Amount (BTC)"})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col justify-end gap-1 mb-2 overflow-hidden",children:v.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between text-xs font-mono relative",children:[(0,s.jsx)("span",{className:"text-red-400 relative z-10",children:e.price}),(0,s.jsx)("span",{className:"text-gray-300 relative z-10",children:e.amount}),(0,s.jsx)("div",{className:"absolute right-0 top-0 bottom-0 bg-red-500/10",style:{width:"".concat(80*Math.random(),"%")}})]},t))}),(0,s.jsxs)("div",{className:"text-center py-2 text-lg font-mono font-bold border-y border-white/5 my-1 text-white",children:[a>0?a.toFixed(2):"---"," ",(0,s.jsx)(n,{size:14,className:"inline text-green-500"})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col justify-start gap-1 mt-2 overflow-hidden",children:p.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between text-xs font-mono relative",children:[(0,s.jsx)("span",{className:"text-green-400 relative z-10",children:e.price}),(0,s.jsx)("span",{className:"text-gray-300 relative z-10",children:e.amount}),(0,s.jsx)("div",{className:"absolute right-0 top-0 bottom-0 bg-green-500/10",style:{width:"".concat(80*Math.random(),"%")}})]},t))})]})]})]})}},1817:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1804:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])}},function(e){e.O(0,[765,971,117,744],function(){return e(e.s=4672)}),_N_E=e.O()}]);