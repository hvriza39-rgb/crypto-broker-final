"use strict";(()=>{var e={};e.id=4403,e.ids=[4403],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},1172:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>b,patchFetch:()=>v,requestAsyncStorage:()=>x,routeModule:()=>m,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f});var a={};t.r(a),t.d(a,{GET:()=>h,dynamic:()=>c});var s=t(9303),o=t(8716),n=t(3131),i=t(7070),u=t(728),d=t(1482),p=t.n(d);let c="force-dynamic",l=process.env.JWT_SECRET||"your-secret-key";async function h(e){try{let r,t;let a=e.headers.get("Authorization"),s=e.headers.get("cookie");if(a&&a.startsWith("Bearer ")?r=a.split(" ")[1]:s&&(r=s.split("token=")[1]?.split(";")[0]),!r)return i.NextResponse.json({error:"Unauthorized"},{status:401});try{t=p().verify(r,l)}catch(e){return i.NextResponse.json({error:"Invalid Token"},{status:401})}let o=t.userId||t.id,n=await u._.user.findUnique({where:{id:o}});if(!n)return i.NextResponse.json({error:"User not found"},{status:404});let d=await u._.transaction.findMany({where:{userId:o},orderBy:{createdAt:"desc"}}),c=d.filter(e=>("deposit"===e.type||"Deposit"===e.type)&&"Completed"===e.status).reduce((e,r)=>e+(r.amount||0),0),h=n.availableBalance||0,m=Math.max(0,h-c),x=c>0?(m/c*100).toFixed(2):"0.00";return i.NextResponse.json({user:{name:n.name,email:n.email},balances:{available:h,profit:m,profitPercent:x},transactions:d})}catch(e){return console.error("DASHBOARD_ERROR:",e),i.NextResponse.json({error:"Server Error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/user/dashboard/route",pathname:"/api/user/dashboard",filename:"route",bundlePath:"app/api/user/dashboard/route"},resolvedPagePath:"C:\\Users\\user\\Documents\\web-upload\\crypto-broker-dashboard-with-admin-connected-backend\\src\\app\\api\\user\\dashboard\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:x,staticGenerationAsyncStorage:f,serverHooks:y}=m,b="/api/user/dashboard/route";function v(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}},728:(e,r,t)=>{t.d(r,{_:()=>s});let a=require("@prisma/client"),s=global.prisma||new a.PrismaClient({log:["query"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[9276,5972,1482],()=>t(1172));module.exports=a})();