"use strict";(()=>{var e={};e.id=8873,e.ids=[8873],e.modules={8013:e=>{e.exports=require("mongodb")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},6995:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>b,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m});var o={};t.r(o),t.d(o,{POST:()=>x});var s=t(9303),n=t(8716),a=t(3131),i=t(7070),u=t(9487),p=t(8691),d=t(1482),l=t.n(d);let c=process.env.JWT_SECRET||"your-secret-key";async function x(e){try{let{email:r,password:t}=await e.json();if(!r||!t)return i.NextResponse.json({error:"Missing fields"},{status:400});let o=await (0,u.z)(),s=await o.collection("users").findOne({email:r});if(!s||!s.password||!await p.ZP.compare(t,s.password))return i.NextResponse.json({error:"Invalid credentials"},{status:401});let n=l().sign({id:s._id,email:s.email,role:s.role||"user"},c,{expiresIn:"7d"});return i.NextResponse.json({success:!0,token:n,role:s.role||"user"})}catch(e){return console.error("Login Error:",e),i.NextResponse.json({error:"Server error"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\user\\Documents\\web-upload\\crypto-broker-dashboard-with-admin-connected-backend\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:v}=g,b="/api/auth/login/route";function f(){return(0,a.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},9487:(e,r,t)=>{let o;t.d(r,{z:()=>a});var s=t(8013);process.env.MONGODB_URI||(process.env.MONGODB_URI="mongodb://localhost:27017/broker-dashboard");let n=process.env.MONGODB_URI;async function a(){return(await o).db()}o=new s.MongoClient(n,{}).connect()}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[9276,5972,1482,8691],()=>t(6995));module.exports=o})();