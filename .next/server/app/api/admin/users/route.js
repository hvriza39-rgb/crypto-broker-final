"use strict";(()=>{var e={};e.id=2628,e.ids=[2628],e.modules={8013:e=>{e.exports=require("mongodb")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8998:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>w,requestAsyncStorage:()=>b,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x});var n={};t.r(n),t.d(n,{DELETE:()=>l,GET:()=>d,PUT:()=>p});var s=t(9303),a=t(8716),o=t(3131),i=t(7070),u=t(9487),c=t(8013);async function d(e){try{let e=await (0,u.z)(),r=(await e.collection("users").find({}).sort({createdAt:-1}).toArray()).map(e=>({_id:e._id,name:e.name,email:e.email,balance:e.balance||0,country:e.country||"",phone:e.phone||"",verified:e.verified||!1,createdAt:e.createdAt}));return i.NextResponse.json(r)}catch(e){return i.NextResponse.json({error:"Server Error"},{status:500})}}async function p(e){try{let{userId:r,_id:t,...n}=await e.json();if(!r)return i.NextResponse.json({error:"Missing User ID"},{status:400});let s=await (0,u.z)(),a={...n};return void 0!==a.balance&&(a.balance=Number(a.balance)),await s.collection("users").updateOne({_id:new c.ObjectId(r)},{$set:a}),i.NextResponse.json({success:!0})}catch(e){return console.error("Update Error:",e),i.NextResponse.json({error:"Update failed"},{status:500})}}async function l(e){try{let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return i.NextResponse.json({error:"Missing ID"},{status:400});let n=await (0,u.z)();return await n.collection("users").deleteOne({_id:new c.ObjectId(t)}),i.NextResponse.json({success:!0})}catch(e){return i.NextResponse.json({error:"Delete failed"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/users/route",pathname:"/api/admin/users",filename:"route",bundlePath:"app/api/admin/users/route"},resolvedPagePath:"C:\\Users\\user\\Documents\\web-upload\\crypto-broker-dashboard-with-admin-connected-backend\\app\\api\\admin\\users\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:b,staticGenerationAsyncStorage:x,serverHooks:h}=m,v="/api/admin/users/route";function w(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},9487:(e,r,t)=>{let n;t.d(r,{z:()=>o});var s=t(8013);process.env.MONGODB_URI||(process.env.MONGODB_URI="mongodb://localhost:27017/broker-dashboard");let a=process.env.MONGODB_URI;async function o(){return(await n).db()}n=new s.MongoClient(a,{}).connect()}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[9276,5972],()=>t(8998));module.exports=n})();